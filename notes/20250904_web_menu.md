# Dotaz:
```
Mam vytvorene tabulky v databazy:
web_pages so stlpcami: id, title, description, text, lang (enum: sk.cs,en), parent_id
seo_data so stlpcami: id, seoble_type, seoble_id, lang (enum: sk.cs,en), slug
seo_data ma unikatny kluc na stlpce: lang, slug

Tabulka web_stranka ma jeden zaznam ako rodicovsky ktoremu su priradeny potomkovia. Potomkovia su jazykove verzie rodicovskeho zaznamu.
Potrebujem vytvorit strukturu tabulky web_menu ktora bude sluzit ako menu na webstranke. Chcem aby si pouzivatel vedel vybrat ci pouzije zaznam z tabulky web_pages ale vytvori novu polozku menu. Potrebujem vsak aby k novej polozke sa dal zadat aj preklad pre jazykovu verziu. Pocet jazykovych verzii sa bude lisit v zavislosti od projektu.

vzor struktury menu na webe:
- domov (odkaz na rodicovsku web stranku: web_pages.id)
- onas	(vytvorena polozka pouzivatelom: potrebne zadavat aj preklady)
    - kontakt	(odkaz na rodicovsku web stranku: web_pages.id)
    - mapa		(odkaz na rodicovsku web stranku: web_pages.id)
    - kariera	(odkaz na rodicovsku web stranku: web_pages.id)
- eshop			(vytvorena polozka pouzivatelom: potrebne zadavat aj preklady)
    - kategoria 1	(odkaz na rodicovsku web stranku: web_pages.id)
    - kategoria 2	(odkaz na rodicovsku web stranku: web_pages.id)
    - kategoria 3	(odkaz na rodicovsku web stranku: web_pages.id)
```

# Odpoved:
Rozumiem, že chcete navrhnúť databázovú štruktúru pre tabuľku `web_menu`, ktorá bude slúžiť na tvorbu menu na webe, pričom bude umožňovať kombináciu odkazov na existujúce stránky (`web_pages`) a vlastné vytvorené položky s prekladmi.

Nasleduje návrh štruktúry a vysvetlenie:

### Návrh tabuľky `web_menu`

```sql
CREATE TABLE web_menu (
    id INT AUTO_INCREMENT PRIMARY KEY,
    parent_id INT NULL, -- odkaz na nadriadenú položku menu, NULL ak je to koreňová položka
    title VARCHAR(255) NOT NULL, -- názov položky menu (napr. "O nás")
    page_id INT NULL, -- odkaz na `web_pages.id`, ak sa položka odkazuje na stránku
    custom_link VARCHAR(255) NULL, -- vlastný odkaz, ak nie je odkaz na stránku
    -- prekladové názvy pre každý jazyk, predpokladáme, že jazykov je viac, použijeme samostatnú tabuľku
    -- alebo môžeme použiť JSON stĺpec na uloženie prekladov
    translations JSON NULL, -- uloženie prekladov vo formáte: { "sk": "O nás", "en": "About us" }
    order_index INT DEFAULT 0 -- pre zoradenie položiek menu
);
```

### Vysvetlenie
- `parent_id` umožňuje vytváranie hierarchií menu (rodičovské položky a ich potomkovia).
- `title` je základný názov položky, ktorý sa môže použiť ako default alebo ako základ pre preklady.
- `page_id` odkazuje na existujúcu stránku v `web_pages`. Ak je NULL, položka bude vlastná (napr. odkaz "O nás").
- `custom_link` je možnosť pre zadanie vlastného URL, ak sa neodkazuje na stránku.
- `translations` je JSON stĺpec, v ktorom môžete uložiť preklady názvov pre rôzne jazyky. Napríklad:
  ```json
  {
    "sk": "O nás",
    "en": "About us"
  }
  ```
- `order_index` slúži na zoradenie položiek v menu.

### Ako to funguje v praxi:
- Ak používateľ vytvorí novú položku menu, zadá jej názov, vyberie, či odkazuje na existujúcu stránku (`web_pages`) alebo zadá vlastný odkaz.
- Pre každý jazyk môže vyplniť preklad názvu, ktorý bude uložený v `translations`.
- Hierarchia je možná pomocou `parent_id`, čím vytvárame podmenu, ako v príklade.

### Ako spravovať preklady:
- Pri vytváraní alebo úprave položky menu bude používateľ zadávať preklady pre každý jazyk, alebo ich dopĺňať neskôr.
- Pri načítaní menu na webe sa zobrazia názvy preložené podľa aktuálneho jazyka, ak existujú, inak sa zobrazí defaultný názov.

---

Ak by ste chceli, môžem vám pripraviť konkrétne SQL dotazy na vytvorenie tabuľky, ukážky vkladu dát alebo načítania menu s prekladmi.

Ak máte ďalšie požiadavky alebo otázky, pokojne ich napíšte!	

# Dotaz: 
```
laravel model
```

# Odpoved:
Samozrejme! Tu je návrh Laravel modelu pre tabuľku `web_menu`, ktorý zodpovedá navrhnutej štruktúre.

### Model `WebMenu.php`

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class WebMenu extends Model
{
    // Názov tabuľky, ak nie je štandardný (množina v tvare plurar)
    protected $table = 'web_menu';

    // Povolené atribúty na hromadné vloženie
    protected $fillable = [
        'parent_id',
        'title',
        'page_id',
        'custom_link',
        'translations',
        'order_index',
    ];

    // Typ atribútu translations ako array (automatická konverzia JSON)
    protected $casts = [
        'translations' => 'array',
    ];

    /**
     * Vzťah na rodičovskú položku menu
     */
    public function parent()
    {
        return $this->belongsTo(WebMenu::class, 'parent_id');
    }

    /**
     * Vzťah na deti (podmenu)
     */
    public function children()
    {
        return $this->hasMany(WebMenu::class, 'parent_id');
    }

    /**
     * Vzťah na stránku v `web_pages`
     */
    public function page()
    {
        return $this->belongsTo(WebPages::class, 'page_id');
    }

    /**
     * Metóda na získanie názvu v aktuálnom jazyku
     */
    public function getTitleByLang($lang)
    {
        if ($this->translations && isset($this->translations[$lang])) {
            return $this->translations[$lang];
        }
        return $this->title;
    }
}
```

### Vysvetlenie:
- Model používa štandardnú konvenciu Laravelu, ale explicitne špecifikuje tabuľku `web_menu`.
- `$casts` zabezpečuje, že `translations` bude automaticky konvertované na pole (array) pri načítaní a uložení.
- Metódy `parent()` a `children()` umožňujú navigáciu hierarchiou menu.
- Metóda `getTitleByLang($lang)` pomáha získať názov v požadovanom jazyku, ak existuje preklad.

### Použitie:
- **Vloženie novej položky:**

```php
WebMenu::create([
    'parent_id' => null,
    'title' => 'Domov',
    'page_id' => 1, // odkaz na stránku
    'custom_link' => null,
    'translations' => [
        'sk' => 'Domov',
        'en' => 'Home'
    ],
    'order_index' => 1,
]);
```

- **Získanie názvu v jazyku:**

```php
$menuItem = WebMenu::find(1);
echo $menuItem->getTitleByLang('sk'); // vypíše "Domov"
```

Ak chcete, môžem vám pripraviť aj ďalšie metódy alebo ukážky použitia!
